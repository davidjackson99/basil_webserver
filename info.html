<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BASIL DB üåø</title>
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <!-- Load color palettes -->
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>

        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .top-bar {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: #4CAF50;
            color: white;
            padding: 10px 0;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }

        #my_dataviz {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #heatmapDescription, .figure-description {
            text-align: left;
            padding: 20px;
            color: #666666;
            font-size: 18px;
            width: 60%;
            margin: auto;
        }
        h1.page-title {
            text-align: center;
            text-decoration: underline;
            margin-top: 70px; /* Adjust this value to position the title correctly */
        }
        .header {
            position: fixed;
            top: 10px;  /* Increase this value to move the header lower */
            right: 0;
            left: 0;
            display: flex;
            justify-content: space-between;
            padding: 0 10px;
        }
        .info-button {
            width: 30px;
            height: 30px;
            border-radius: 50%; /* Makes the button round */
            background-color: #ffffff; /* Blue background color */
            color: #000000;
            border: none;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        .index-button {
            width: 30px;
            height: 30px;
            border-radius: 50%; /* Makes the button round */
            background-color: #ffffff; /* Blue background color */
            color: #000000;
            border: none;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        .iframe-container {
    display: flex;
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
    height: 100vh; /* Full height of the viewport */
}

    </style>
</head>
<body>
    <div class="top-bar">BASIL DB üåø</div>
    <div class="header">
        <button class="info-button" onclick="window.location.href='about.html'">üìó</button>
        <button class="index-button" onclick="window.location.href='index.html'">üîé</button>
    </div>
    <h1 class="page-title">BASIL DB üåø</h1>

    <div class="figure-description">
        <p><b>BASIL</b> (Bioactive Analysis for Systematic Insights and Longevity) was developed to guide users through the complexities of nutritional data through the study of bioactive compounds, enhancing understanding and simplifying access to health insights. <br><br> Stay on this page to get an overview of our data by exploring interactive visualizations that illustrate its intricate relationships and patterns. If you're looking for specific information, visit our <a href="index.html">Search page</a> where you can query bioactives, conditions, or foods to access detailed evidence summaries. For insights into our project's background, methodology, and the team behind BASIL, check out our <a href="about.html">About page</a>.</p>
    </div>
    <div id="my_dataviz"></div>
    <div id="heatmapDescription">
        The BASIL project utilizes advanced NLP tools including GPT-4.0 Turbo, RobotReviewer, MetaMap, and rule-based methods to systematically extract and categorize data from clinical trials, focusing on study focus, health benefits, population characteristics, and biases. Health benefits and population terms are mapped to the Unified Medical Language System (UMLS) to enhance the precision of our knowledge graph (KG), which links bioactives to health conditions. Weights are calculated between bioactives and foods or health conditions based on normalized content and empirical evidence to quantify the strength of these relationships. Additionally, our methodology accounts for both significant and non-significant health effects, ensuring comprehensive coverage of trial outcomes and supporting rigorous meta-analyses.
    </div>
    <div class="figure-description">
        <p>The above heatmap visualizes the efficacy of various bioactive compounds against a range of health conditions, such as Pruritus, Asthma, Rheumatoid Arthritis, and more. Arranged horizontally are compounds like Quercetin, Curcumin, and Coenzyme Q10, among others. Each colored cell in the heatmap reflects the strength of association between a compound and a health effect, with lighter colors indicating stronger relationships. For instance, there seems comparably high
evidence for the connection between Capsaicin and the concept ‚ÄùPain‚Äù or Curcumin and the concept
‚ÄùInflammation‚Äù.</a></p>
    </div>


    <div class="iframe-container">
    <iframe src="tanimoto_plot.html" width="725" height=750" frameborder="0";"></iframe>
     </div>

    <div class="figure-description">
        <p>This visualization demonstrates the Tanimoto similarity coefficients among various bioactive compounds, highlighting potential overlaps and unique properties in their biological activities. The Tanimoto coefficient, also known as the Jaccard index, is a measure of the similarity between two sets and is calculated using the formula:</p>
        <p style="text-align: center; font-weight: bold;">T(A, B) = |A ‚à© B| / |A ‚à™ B|</p>
        <p>Where <i>A</i> and <i>B</i> are sets of characteristics (e.g., chemical properties, biological activities) for two different compounds. The coefficient ranges from 0 to 1, where 0 indicates no similarity and 1 indicates identical sets. In this context, it quantifies how closely the properties of one bioactive compound resemble those of another, providing insights into their structural and functional relationships.</p>
        <p>The visual displayed is an MDS (Multidimensional Scaling) plot, which projects the high-dimensional data of the similarity coefficients into a two-dimensional space. This projection allows for the intuitive visualization of the relationship dynamics between compounds, with closer points indicating higher similarity. The MDS plot is particularly useful for identifying clusters of bioactives with similar effects and exploring the diversity within the dataset.</p>
        <p>In our dataset, as can be seen above, we differentiate compounds such as Theanine and L-Theanine based on their molecular orientation to emphasize stereoisomerism, highlighting that despite having the same molecular formula, their atoms' spatial arrangement can vary. Additionally, certain synthetic compounds like Telmisartan, sourced from the original datasets, are included for their functional similarities to naturally occurring bioactives, such as their role in blood pressure regulation. This comprehensive approach aids in comparing and understanding the therapeutic potentials and biochemical behaviors of both synthetic and natural compounds.</p>
        <br>
    </div>

    <div class="figure-description">

        <p>Beyond the structural similarity between compounds, BASIL lets us identify the effect similarity between compounds. That is, we can see how similar the existing literature is for two compounds regarding their health effects. For this purpose, we define the weight between a compound and a health effect as follows: </p>

        <p>For each research paper that discusses both a specific bioactive compound and a health condition, we assign weights based on the type of study, the number of participants, and an adjusted bias score. The weight of the study, \(E_p\), varies by the study type: Single Compound studies are weighted at 6, Combination Therapy or Comparative studies at 4, Derivative studies at 2, and all other study types at 1.</p>

        <p>The number of participants, \(N_p\), is normalized to moderate the influence of studies with large sample sizes. We use the formula \(N_p' = \frac{\log(N_p + 1)}{\log(\max(N) + 1)}\), where \(\max(N)\) is the maximum number of participants in any study. Additionally, the bias score, \(B_p\), ranges from 0 (no bias) to 1 (maximum bias), and is adjusted to \(B_p' = 1 - B_p^{0.5}\) to lessen the impact of higher biases on the study‚Äôs weight.</p>

        <p>The overall weight for each paper is calculated as \(w_p = E_p \cdot N_p' \cdot B_p'\). The total weight for the relationship between a bioactive and a health condition is the sum of weights from all pertinent studies, expressed as \(w(c,h) = \sum_i w_i\), with \(i\) indexing the included papers.</p>

        <p>We can explore the literature similarity of up to three compounds using the following visualization. Here, red nodes represent health effect concepts (such as "Anxiety", "Inflammation", or "Blood Pressure") and green nodes represent bioactive compounds. You can adjust the threshold of minimum edge weight using the slider. </p>

    </div>

    <div class="iframe-container">
    <iframe src="graph_connect.html" width="700" height="700" frameborder="0";"></iframe>
    </div>

    <div class="figure-description">
        <p>Lastly, the visualization below allows you to interactively explore how different foods impact health. By selecting various food items, you can see a breakdown of their bioactives (which were scraped for BASIL), and how these relate to specific health conditions. The tool connects each food item to potential health outcomes based on the results of our automated literature review. You can also adjust how many health conditions are displayed for each compound by changing the maximum number of most highly related conditions to simplify or deepen your analysis. We have set the minimum weight between compounds and conditions to 15, explaining why some compounds are not linked to any conditions.</p>
    </div>

    <div class="iframe-container">
    <iframe src="sankey.html" width="1025" height=650" frameborder="0";"></iframe>
     </div>

    <div class="figure-description">
        <p>It's important to note that the number of compounds listed for each food does not necessarily reflect its health value. Some very healthy foods may link to only one or a few compounds, while others might connect to many, due to ongoing research and data compilation. This aspect of the tool will continue to evolve as more information becomes available and is integrated into the database. For exact nutrient values in each food, please use the <a href="index.html">search tool</a> to look up specific food items or visit <a href="https://foodb.ca">FooDB</a> for more detailed information. </p>
    </div>


    <script>

        var margin = {top: 100, right: 100, bottom: 100, left: 100}, // Increased margins
            width = 600 - margin.left - margin.right, // Adjusted width
            height = 600 - margin.top - margin.bottom; // Adjusted height

        var svg = d3.select("#my_dataviz")
            .append("svg")
            .attr("width", -5 * width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform",
                "translate(" + margin.left + "," + margin.top + ")");

        // Load and process the data
        d3.json("data/weights_v1.json", function (error, data) {
            if (error) throw error;

            // Filter data for predefined bioactives and health effects
            var predefinedBioactives = ["Quercetin", "Curcumin", "Carnitine", "Chitosan", "Carotene", "Capsaicin", "Arachidonic acid", "Docosahexaenoic acid (DHA)", "Selenium", "Coenzyme Q10"]; // List your bioactives here
            var predefinedEffects = ["Hypotension", "Fatigue", "Anxiety", "Inflammation", "Diabetes type", "Cardiac Arrest", "Obesity", "Wound Healing", "Pruritus", "Pain"]; // List your effects here

            // Initialize a complete data matrix with default values (weight = 0)
            var completeData = [];
            predefinedBioactives.forEach(function (bioactive) {
                predefinedEffects.forEach(function (effect) {
                    completeData.push({
                        Bioactive: bioactive,
                        Condition: effect,
                        Weight: 0  // Default weight is 0
                    });
                });
            });

            // Merge the actual data into the complete data matrix
            data.forEach(function (entry) {
                if (predefinedBioactives.includes(entry.Bioactive) && predefinedEffects.includes(entry.Condition)) {
                    var match = completeData.find(d => d.Bioactive === entry.Bioactive && d.Condition === entry.Condition);
                    if (match) {
                        match.Weight = entry.Weight;  // Update the weight from the actual data
                    }
                }
            });

            // Create a tooltip
            var tooltip = d3.select("#my_dataviz")
                .append("div")
                .style("opacity", 0)
                .attr("class", "tooltip")
                .style("background-color", "white")
                .style("border", "solid")
                .style("border-width", "2px")
                .style("border-radius", "5px")
                .style("padding", "5px");

            // Prepare scales and SVG canvas
            var x = d3.scaleBand()
                .range([0, width])
                .domain(predefinedBioactives)
                .padding(0.05);
            var y = d3.scaleBand()
                .range([height, 0])
                .domain(predefinedEffects)
                .padding(0.05);

            var svg = d3.select("#my_dataviz").append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            svg.append("g")
                .style("font-size", 15)
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x).tickSize(0))
                .selectAll("text")  // select all the text elements for the xaxis
                .style("text-anchor", "end") // anchor the text at the end of the tick
                .attr("dx", "-.8em") // adjust positions to better align, especially when rotated
                .attr("dy", ".15em")
                .attr("transform", "rotate(-45)") // rotate the text
                .select(".domain").remove(); // remove the axis line, keeping only the labels

            svg.append("g")
                .style("font-size", 15)
                .call(d3.axisLeft(y).tickSize(0))
                .select(".domain").remove();

            var myColor = d3.scaleSequential()
                .interpolator(d3.interpolateInferno)
                .domain([0, 90]);  // Adjust based on your dataset's range

            // Add the squares
            svg.selectAll()
                .data(completeData, function (d) {
                    return d.Bioactive + ':' + d.Condition;
                })
                .enter()
                .append("rect")
                .attr("x", function (d) {
                    return x(d.Bioactive)
                })
                .attr("y", function (d) {
                    return y(d.Condition)
                })
                .attr("rx", 4)
                .attr("ry", 4)
                .attr("width", x.bandwidth())
                .attr("height", y.bandwidth())
                .style("fill", function (d) {
                    return myColor(d.Weight)
                })
                .style("stroke-width", 4)
                .style("stroke", "none")
                .style("opacity", 0.8)
                .on("mouseover", function (d) {
                    tooltip.style("opacity", 1);
                    d3.select(this).style("stroke", "black").style("opacity", 1);
                })
                .on("mousemove", function (d) {
                    tooltip.html("The exact value of<br>this cell is: " + d.Weight.toFixed(2))
                        .style("left", (d3.event.pageX + 20) + "px")
                        .style("top", (d3.event.pageY + 20) + "px");
                })
                .on("mouseleave", function (d) {
                    tooltip.style("opacity", 0);
                    d3.select(this).style("stroke", "none").style("opacity", 0.8);
                });
            // Add title to graph
            svg.append("text")
                .attr("x", 0)
                .attr("y", -50)
                .attr("text-anchor", "left")
                .style("font-size", "22px")
                .text("Bioactive Compound vs. Health Effect Heatmap");

            // Add subtitle to graph
            svg.append("text")
                .attr("x", 0)
                .attr("y", -20)
                .attr("text-anchor", "left")
                .style("font-size", "14px")
                .style("fill", "grey")
                .text("Heatmap representing the relationship strength based on weighted values.");
        });


    </script>
</body>
</html>
